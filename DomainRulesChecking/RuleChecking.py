from DomainRules import DomainRules, PVS

def main():
    '''sample="""int main(int argc, char **argv)
{
    int x = 10 + 100;       // immediate expression - easy to filter out
    int y = 10 + x;         // not immediate but known provenance
    int z = 10 + y + argc;  // unknown provenance
    char *s = (char *)malloc(z + y + x);
    s[10] = 'a';
    int result = (int)s[10];
    printf("%c\n", *s);
    free(s);
    free(s);
    s = 0;
    s += 1;
    s++;
    struct foo* ss;
    ss->bar = x;
    *ss.baz = y;
    return result;
}
"""'''
    sample="""int main()
        {
            int a;
            printf("hello")
            scanf("%d",a);
            printf(a);
        }
    """
    rules=PVS(sample)
    
    result=rules.get_pvs_v2()
    
    print(result)
    
    #print(ast_tokens)
    #print(pvs_maps)

if __name__ == "__main__":
    main()

